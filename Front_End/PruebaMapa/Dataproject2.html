<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Add a geocoder</title>
  <meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no">
  <link href="https://api.mapbox.com/mapbox-gl-js/v2.6.1/mapbox-gl.css" rel="stylesheet">
  <script src="https://api.mapbox.com/mapbox-gl-js/v2.6.1/mapbox-gl.js"></script>
  <style>
    body { margin: 0; padding: 0; }
    #map { position: absolute; top: 0; bottom: 0; width: 100%; }
  </style>
  <!-- Load the `mapbox-gl-geocoder` plugin. -->
  <script src="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v5.0.0/mapbox-gl-geocoder.min.js"></script>
  <link rel="stylesheet" href="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v5.0.0/mapbox-gl-geocoder.css" type="text/css">
</head>
<body>
  <!-- Map container where the map will be displayed -->
  <div id="map"></div>

  <script>
    // Your JavaScript code goes here
    mapboxgl.accessToken = "pk.eyJ1IjoicGF1bHZsYyIsImEiOiJjbHJudDkxOWYxMnV6Mm1xcjUzc2RtYWtqIn0.w0tY4u_L6iDePq9uK30A1Q";

    navigator.geolocation.getCurrentPosition(successLocation, errorLocation, {
      enableHighAccuracy: true
    })

    function successLocation(position) {
      setupMap([position.coords.longitude, position.coords.latitude])
    }

    function errorLocation() {
      setupMap([-0.37739, 39.46975]) // Default to Valencia's coordinates
    }

    function setupMap(center) {
      const map = new mapboxgl.Map({
        container: "map",
        style: "mapbox://styles/mapbox/streets-v11",
        center: center,
        zoom: 15
      })

      const nav = new mapboxgl.NavigationControl()
      map.addControl(nav)

      // Add the Mapbox Geocoder Control
      map.addControl(
        new MapboxGeocoder({
          accessToken: mapboxgl.accessToken,
          mapboxgl: mapboxgl
        })
      )

      var directions = new MapboxDirections({
        accessToken: mapboxgl.accessToken
      })

      map.addControl(directions, "top-left")
    }
  </script>
</body>
</html>



